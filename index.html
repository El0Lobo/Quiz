<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pepsi's Quiz</title>

  <!-- Styles -->
  <link rel="stylesheet" href="quiz.css" />
  <style>
    .answers .opt { cursor: pointer; user-select: none; display:flex; align-items:center; gap:.5rem; padding:.4rem .6rem; border-radius:.6rem; }
    .answers .opt.picked { outline: 2px solid currentColor; }
    .answers .opt.hidden { display: none; }
    .answers .opt.correct { background: rgba(50,205,50,.12); box-shadow: inset 0 0 0 2px rgba(50,205,50,.35); }
    .answers .opt.correct.missed { opacity: .55; }
    .answers .opt.wrong { background: rgba(220,20,60,.12); box-shadow: inset 0 0 0 2px rgba(220,20,60,.35); }
    button[disabled] { opacity:.5; cursor:not-allowed; }
  </style>
</head>

<body>
  <img id="flaus" class="anim-image" src="Flaus.png" alt="Click me for a surprise animation" title="Click me!" draggable="false" />

  <div class="app card" id="app">
    <header>
      <div class="brand">
        <div class="logo"><span>μ</span></div>
        <h1>Pepsi's Master Quiz</h1>
      </div>
      <div class="scorebar">
        <span class="chip info" id="categoryChip">Loading…</span>
        <span class="chip accent" id="pointsChip">0 / 0 pts</span>
        <span class="chip" id="qpos">Question 0/0</span>
        <span class="chip danger" id="lifes">50/50 × 3</span>
      </div>
    </header>

    <!-- START SCREEN -->
    <main id="screenStart">
      <div class="grid">
        <section class="panel">
          <h2>Choose what you want to study</h2>
          <div class="flex" style="margin-bottom:10px">
            <button class="btn ghost" id="selectAll" type="button">Select all</button>
            <button class="btn ghost" id="clearAll" type="button">Clear all</button>
          </div>
          <div class="cats" id="categories"></div>
        </section>

        <aside class="panel">
          <h2>Game settings</h2>
          <div class="row" style="margin-bottom:10px">
            <label>Available in selected categories</label>
            <div class="flex">
              <span class="chip info" id="availableCount">0 available</span>
              <button class="btn secondary" id="btnAll"  type="button" title="Use all available">All</button>
              <button class="btn secondary" id="btn25"  type="button">25</button>
              <button class="btn secondary" id="btn50"  type="button">50</button>
              <button class="btn secondary" id="btn100" type="button">100</button>
            </div>
          </div>
          <div class="row" style="margin-bottom:10px">
            <label for="numQuestions">Total questions</label>
            <input id="numQuestions" type="number" min="1" step="1" value="12" disabled />
          </div>
          <div class="row" style="margin-bottom:10px">
            <label>Question order</label>
            <select id="order">
              <option value="mixed" selected>Mixed & shuffled</option>
              <option value="byCategory">Group by category (shuffled within)</option>
            </select>
          </div>
          <div class="sub" id="sourceInfo" style="display: none;">Source: <em>loading…</em></div>
        </aside>
      </div>

      <div class="flex right" style="margin-top:16px">
        <button id="startBtn" class="btn primary" type="button">Start Quiz</button>
      </div>
    </main>

    <!-- QUIZ SCREEN -->
    <main id="screenQuiz" class="hidden">
      <div class="qwrap">
        <div class="qhead">
          <div class="flex">
            <span class="badge" id="catBadge">Category</span>
            <span class="badge" id="modeBadge" title="Select all that apply">Multiple answers</span>
            <span class="badge" id="ptsBadge">+0 pts</span>
          </div>
          <div class="lifelines">
            <button class="btn secondary" id="fiftyBtn" type="button" title="Eliminate some incorrect options (3 uses per run)">50/50</button>
            <span class="chip danger" id="lifeCount">× 3 left</span>
          </div>
        </div>

        <div class="progress"><div class="bar" id="bar"></div></div>
        <div id="qnum" class="tag">Question 1</div>
        <div id="qtext" class="question">—</div>
        <div id="sataNote" class="sata hidden">This question has multiple correct answers — <b>select all that apply</b>.</div>

        <div id="answers" class="answers"></div>
        <div id="explain" class="explain hidden"></div>

        <div class="flex right">
          <button class="btn secondary" id="skipBtn" type="button" title="Skip this question (no points)">Skip</button>
          <button class="btn primary" id="nextBtn" type="button" disabled>Next</button>
        </div>
        <div class="tag">Keyboard: numbers to select • <kbd>F</kbd> 50/50 • <kbd>Enter</kbd>/<kbd>N</kbd> check/next</div>
      </div>
    </main>

    <!-- RESULT SCREEN -->
    <main id="screenResult" class="hidden">
      <div class="result">
        <h2 class="big" id="winTitle">Well done!</h2>
        <p id="summary"></p>
        <div class="flex" style="justify-content:center; gap:16px">
          <span class="chip accent" id="finalScore">0 pts</span>
          <span class="chip" id="accuracy">Score: 0%</span>
          <span class="chip info" id="catsPlayed">—</span>
        </div>
        <div class="flex" style="justify-content:center; gap:10px; margin-top:12px">
          <button class="btn secondary" id="reviewBtn" type="button">Review answers</button>
          <button class="btn primary" id="restartBtn" type="button">Play again</button>
        </div>
        <div id="review" class="panel hidden" style="text-align:left"></div>
      </div>
    </main>
  </div>

  <!-- ────────────────────────────────────────────────────────
       REGISTRATION SHIM (must come BEFORE your data files)
       Each data file calls: registerQuestions('Nice Name', ARRAY)
       ──────────────────────────────────────────────────────── -->
  <script>
    window.__QUIZ_SETS__ = window.__QUIZ_SETS__ || [];
    window.__QUIZ_SET_NAMES__ = window.__QUIZ_SET_NAMES__ || [];
    window.registerQuestions = function(name, arr){
      if (arr && Array.isArray(arr)) {
        window.__QUIZ_SETS__.push(arr);
        window.__QUIZ_SET_NAMES__.push(name || `set${window.__QUIZ_SETS__.length}`);
      } else if (arr && Array.isArray(arr.questions)) {
        window.__QUIZ_SETS__.push(arr.questions);
        window.__QUIZ_SET_NAMES__.push(name || `set${window.__QUIZ_SETS__.length}`);
      } else {
        console.warn('registerQuestions: ignored non-array payload for', name);
      }
    };
  </script>

  <!-- Load ANY number of data files; each should call registerQuestions(...) -->
  <script src="questions.js"></script>

  <!-- Main app -->
  <script src="quiz.js"></script>
  <script src="editor.js"></script>

</body>
</html>
